// Generated by LiveScript 1.4.0
(function(){
  var philtre, readStdinAsLinesThen, noEmpty, philtreFromStdin;
  philtre = require("./philtre").philtre;
  readStdinAsLinesThen = function(func){
    var buf;
    buf = '';
    process.stdin.setEncoding('utf-8');
    process.stdin.on('data', function(it){
      return buf += it;
    });
    return process.stdin.on('end', function(){
      return func(noEmpty(
      buf.split("\n")));
    });
  };
  noEmpty = function(it){
    return it.filter(function(it){
      return !(it === null || it === '');
    });
  };
  philtreFromStdin = function(){
    return readStdinAsLinesThen(function(it){
      var query, key, objects;
      query = process.argv[2];
      key = process.argv[3];
      objects = it.map(JSON.parse);
      return philtre(query, objects).map(function(out){
        if (key) {
          out = out[key];
        }
        return console.log(JSON.stringify(out));
      });
    });
  };
  philtreFromStdin();
}).call(this);
